---
title: 'SOCIODEMOGRAFIA DA TURMA </br> (AULA 02)'
subtitle: 'ADM03F - Macroeconomia'
author: 'Autor: Victor Valerio'
date: 'Última atualização: `r format(Sys.Date(),"%d-%m-%Y")`'
output:
  xaringan::moon_reader:
    css: [xaringan-themer.css]
    nature:
      highlightStyle: github
      highlightLines: true
      ratio: 16:9
      countIncrementalSlides: true
---


```{r xaringan-themer, include=FALSE, warning=FALSE}


library(xaringanthemer)


style_mono_light(base_color = '#23395b')


```


```{r xaringan-scribble, echo=FALSE}


xaringanExtra::use_scribble()

xaringanExtra::use_search(show_icon = TRUE)


```


```{r dados, include=FALSE, warning=FALSE}


`%>%` <- magrittr::`%>%`



respostas <- readr::read_csv2('C:/Users/victo/Documents/PROJETOS_R/2021/disciplinas/adm03f/dados/respostas_2021.csv') %>%

  janitor::clean_names()



colnames(respostas) <- c('carimbo', 'participante', 'idade', 'naturalidade', 'genero', 'origem_estudo',

                         'religiosidade', 'escolaridade_pai', 'idade_pai', 'escolaridade_mae', 'idade_mae',

                         'religiosidade_pai', 'religiosidade_mae', 'renda_familiar', 'hierarquia', 'jeitinho',

                         'violencia_institucional', 'desenvolvimentismo', 'cotas', 'aborto', 'liberalismo',

                         'homo_masculina', 'homo_feminina', 'censura', 'bolsa_familia', 'primeira_escolha',

                         'segunda_escolha', 'utilitarismo')



```


## TÓPICOS ABORDADOS

</br>

[**PIB (preços de mercado)**](#pib_precos_mercado)

</br>

[**PIB (número índice)**](#pib_numero_indice)

</br>

[**PIB (com ajuste sazonal)**](#pib_com_ajuste_sazonal)

</br>

[**PIB versus Desemprego**](#pib_versus_desemprego)

</br>

[**PIB versus RNB**](#pib_versus_rnb)


---


class: inverse, center, middle 
name: pib_precos_mercado


## PRODUTO INTERNO BRUTO </br> (PREÇOS DE MERCADO)


---

<div style="text-align: justify">

## PRODUTO INTERNO BRUTO (PREÇOS DE MERCADO)

**CONCEITOS VISTOS NA ÚLTIMA AULA**:

</br>

- O **Produto Interno Bruto (PIB)** corresponde ao cálculo do **Produto Agregado** com foco no 
**âmbito geográfico**;

</br>

- O **PIB** corresponde a um **indicador de nível de produção** de um país em um determinado período 
de tempo (isto é chamado de **variável de fluxo**);

</br>

- Como toda **renda** é formada a partir do **valor adicionado** (ou valor agregado) gerado na produção,
o **PIB** também pode ser compreendido como um **indicador de renda agregada da população**;

</br>

- Nas formulações macroeconômicas o **PIB** é representado pela letra **Y**.


---

<div style="text-align: justify">

## PRODUTO INTERNO BRUTO (PREÇOS DE MERCADO)

**VISÃO PRÁTICA**:

</br>

- Na prática, o PIB pode ser calculado considerando diferentes preços para os bens ou serviços 
produzidos, são exemplos:

    - **PIB a preços básicos**, em que os preços dos produtos são calculados ao se considerar o valor na 
    dos bens ou serviços na "porta da fábrica";
    
    - **PIB a preços de mercado**, em que os preços dos produtos são calculados ao se considerar os preços
    básicos com adição de impostos líquidos (impostos menos subsídios), margens de comércio e de 
    transporte.
    
</br>
    
- Durante o curso nós nos concentraremos no **PIB a preços de mercado** de modo a considerar apenas 
os preços para o consumidor final.

---

class: center, middle 



```{r, warning = F,message = F, error = F, echo = F, fig.align = 'center', fig.width = 3, fig.height = 2, dpi = 300}


agregados_macroeconomicos <- sidrar::get_sidra(api = '/t/2072/n1/all/v/933,936,938/p/all',

                                               period = as.Date('2020-04-01')) %>%

  janitor::clean_names() %>%

  dplyr::mutate(date = zoo::as.yearqtr(trimestre_codigo, format = '%Y %q')) %>%

  dplyr::select(date, valor, variavel) %>%
  
  dplyr::rename('Trimestre' = date,
                
                'PIB' = valor) %>% 

  dplyr::filter(variavel != '(=) Renda nacional disponível bruta') %>%

  dplyr::mutate(variavel = dplyr::case_when(variavel == 'Produto Interno Bruto' ~ 'Produto Interno Bruto - PIB (Y)',

                                            variavel == '(=) Renda nacional bruta' ~ 'Renda nacional disponível bruta - RNB'))


pib_precos_mercado <- agregados_macroeconomicos %>% 
  
  dplyr::filter(variavel == 'Produto Interno Bruto - PIB (Y)') %>% 
  
  ggplot2::ggplot() +
  
    ggplot2::geom_line(mapping = ggplot2::aes(x = Trimestre, y = PIB),

                     colour = '#23395b',

                     size = .5) +

  ggplot2::geom_point(mapping = ggplot2::aes(x = Trimestre, y = PIB),

                      colour = '#23395b') +
  
  ggplot2::labs(title = 'Produto Interno Bruto - PIB (Y) \nPreços de Mercado',
                
                y = 'Milhões de Reais',
              
                x = 'Trimestres') +
  
  ggplot2::scale_y_continuous(labels = scales::dollar_format(prefix = 'R$ ', big.mark = '.')) +
  
  xaringanthemer::theme_xaringan(text_font_size = 12,
                                 
                                 title_font_size = 15)


plotly::ggplotly(pib_precos_mercado)


```


---


class: inverse, center, middle 
name: pib_numero_indice


## PRODUTO INTERNO BRUTO (NÚMERO ÍNDICE)


---


class: center, middle 


## PRODUTO INTERNO BRUTO (NÚMERO ÍNDICE)


```{r, echo = F, fig.align = 'center', fig.width = 7, fig.height = 3, dpi = 300}



respostas %>%

  ggplot2::ggplot() +

  ggplot2::geom_bar(mapping = ggplot2::aes(y = genero), 
                    
                    fill = '#23395b',
                    
                    width = 0.25) +

  ggplot2::labs(y = 'Identificação de Gênero',

                x = 'Total de Estudantes') +

  ggplot2::scale_x_continuous(breaks = seq(0,40,2)) +
  
  xaringanthemer::theme_xaringan(text_font_size = 12,
                                 
                                 title_font_size = 15) 


```


---

class: inverse, center, middle 
name: pib_com_ajuste_sazonal



## PRODUTO INTERNO BRUTO COM AJUSTE SAZONAL


---

class: center, middle 


## PRODUTO INTERNO BRUTO COM AJUSTE SAZONAL


```{r, echo = F, fig.align = 'center', fig.width = 7, fig.height = 3, dpi = 300}

respostas %>%

  ggplot2::ggplot() +

  ggplot2::geom_bar(mapping = ggplot2::aes(y = origem_estudo), 
                    
                    fill = '#23395b',
                    
                    width = 0.5) +

  ggplot2::labs(y = 'Origem da Escolaridade',

                x = 'Total de Estudantes') +

  ggplot2::scale_x_continuous(breaks = seq(0,40,2)) +
  
  xaringanthemer::theme_xaringan(text_font_size = 12,
                                 
                                 title_font_size = 15) 




```


---

class: inverse, center, middle 
name: pib_versus_desemprego


## PRODUTO INTERNO BRUTO E DESEMPREGO


---

class: center, middle 


## PRODUTO INTERNO BRUTO E DESEMPREGO


```{r, echo = F, fig.align = 'center', fig.width = 7, fig.height = 3, dpi = 300}


respostas %>%

  ggplot2::ggplot() +

  ggplot2::geom_bar(mapping = ggplot2::aes(y = religiosidade), 
                    
                    fill = '#23395b',
                    
                    width = 0.25) +

  ggplot2::labs(y = 'Religiosidade',

                x = 'Total de Estudantes') +

  ggplot2::scale_x_continuous(breaks = seq(0,22,2)) +
  
  xaringanthemer::theme_xaringan(text_font_size = 12,
                                 
                                 title_font_size = 15) +
  
  xaringanthemer::scale_xaringan_fill_discrete()




```


---

class: inverse, center, middle 
name: pib_versus_rnb


## PRODUTO INTERNO BRUTO E RENDA NACIONAL BRUTA


---

class: center, middle 


## PRODUTO INTERNO BRUTO E RENDA NACIONAL BRUTA


```{r, echo = F, fig.align = 'center', fig.width = 7, fig.height = 3, dpi = 300}


respostas %>%

  dplyr::select(participante, escolaridade_pai, escolaridade_mae) %>%

  tidyr::pivot_longer(-participante, names_to = 'ref', values_to = 'escolaridade') %>%

  ggplot2::ggplot() +

  ggplot2::geom_bar(mapping = ggplot2::aes(y = escolaridade, fill = ref), 
                    
                    position = ggplot2::position_dodge2(preserve = 'single'),
                    
                    width = 0.75) +

  ggplot2::labs(y = 'Nível de Escolaridade',

                x = 'Quantidade Total',

                fill = '') +

  ggplot2::scale_x_continuous(breaks = seq(0,21,1)) +
  
  ggplot2::theme(legend.position = 'bottom') +
  
  xaringanthemer::theme_xaringan(text_font_size = 12,
                                 
                                 title_font_size = 15) +
  
  ggplot2::scale_fill_manual(labels = c('Mãe', 'Pai'),
                             
                             values = c('#4A3844', '#23395b'))



```


<!-- --- -->

<!-- class: inverse, center, middle  -->
<!-- name: renda -->


<!-- ## RENDA FAMILIAR DOS ESTUDANTES -->


<!-- --- -->

<!-- class: center, middle  -->


<!-- ## RENDA FAMILIAR DOS ESTUDANTES -->


<!-- ```{r, echo = F, fig.align = 'center', fig.width = 7, fig.height = 3, dpi = 300, warning = FALSE} -->


<!-- respostas %>% -->

<!--   ggplot2::ggplot() + -->

<!--   ggplot2::geom_boxplot(mapping = ggplot2::aes(y = renda_familiar), -->

<!--                         fill = '#23395b',  -->

<!--                         alpha = 0.5) + -->

<!--   ggplot2::labs(y = 'Renda', -->

<!--                 x = '') + -->

<!--   ggplot2::scale_y_continuous(labels = scales::dollar_format(prefix = 'R$', big.mark = '.')) + -->

<!--   ggplot2::theme(axis.text.x = ggplot2::element_blank()) + -->

<!--   xaringanthemer::theme_xaringan(text_font_size = 12, -->

<!--                                  title_font_size = 15)  -->

<!-- ``` -->


<!-- --- -->

<!-- class: inverse, center, middle  -->
<!-- name: idade_pais -->


<!-- ## IDADE DOS PAIS -->


<!-- --- -->

<!-- class: center, middle  -->


<!-- ## IDADE DOS PAIS -->


<!-- ```{r, echo = F, fig.align = 'center', fig.width = 7, fig.height = 3, dpi = 300} -->


<!-- respostas %>% -->

<!--   dplyr::select(participante, idade, idade_pai, idade_mae) %>% -->

<!--   tidyr::pivot_longer(-participante, names_to = 'ref', values_to = 'idades') %>% -->

<!--   ggplot2::ggplot() + -->

<!--   ggplot2::geom_boxplot(mapping = ggplot2::aes(fill = ref, y = idades), alpha = 0.5) + -->

<!--   ggplot2::labs(y = 'Idades', -->

<!--                 x = '', -->

<!--                 fill = '') + -->

<!--   ggplot2::scale_y_continuous(limits = c(10,75), -->

<!--                               breaks = seq(10,80,10)) + -->

<!--   ggplot2::scale_fill_manual(labels = c('Estudante','Mãe', 'Pai'), -->

<!--                              values = c('#3E4635', '#4A3844', '#23395b')) + -->

<!--   ggplot2::theme(legend.position = 'bottom', -->

<!--                  axis.text.x = ggplot2::element_blank()) + -->

<!--    xaringanthemer::theme_xaringan(text_font_size = 12, -->

<!--                                  title_font_size = 15)  -->



<!-- ``` -->


<!-- --- -->

<!-- class: inverse, center, middle  -->
<!-- name: cabeca_estudantes -->


<!-- ## A CABEÇA DOS ESTUDANTES -->


<!-- --- -->

<!-- class: center, middle  -->


<!-- ## A CABEÇA DOS ESTUDANTES -->


<!-- ```{r, echo = F, fig.align = 'center', fig.width = 7, fig.height = 3, dpi = 300} -->


<!-- respostas %>% -->

<!--   dplyr::select(participante, hierarquia, jeitinho, -->

<!--                 violencia_institucional, desenvolvimentismo, cotas, aborto, liberalismo, -->

<!--                 homo_masculina, homo_feminina, censura, bolsa_familia, utilitarismo) %>% -->

<!--   tidyr::pivot_longer(-participante, names_to = 'ref', values_to = 'social') %>% -->

<!--   ggplot2::ggplot(mapping = ggplot2::aes(y = ref, x = social)) + -->

<!--   ggplot2::geom_boxplot(mapping = ggplot2::aes(x = social), fill = '#23395b', alpha = 0.5) + -->

<!--   ggplot2::labs(y = 'Item analisado', -->

<!--                 x = '', -->

<!--                 fill = '') + -->

<!--   ggplot2::scale_x_continuous(breaks = seq(1, 6, 1)) + -->

<!--   ggplot2::theme(legend.position = 'none') + -->

<!--   ggplot2::scale_y_discrete(labels = c('Aborto', -->

<!--                                        'Bolsa Família', -->

<!--                                        'Censura', -->

<!--                                        'Cotas', -->

<!--                                        'Desenvolvimentismo', -->

<!--                                        'Hierarquia', -->

<!--                                        'Homoafetividade Feminina', -->

<!--                                        'Homoafetividade Masculina', -->

<!--                                        'Jeitinho Brasileiro', -->

<!--                                        'Liberalismo', -->

<!--                                        'Utilitarismo', -->

<!--                                        'Violência Institucional')) + -->

<!--    xaringanthemer::theme_xaringan(text_font_size = 12, -->

<!--                                  title_font_size = 15)  -->



<!-- ``` -->


<!-- --- -->

<!-- class: inverse, center, middle  -->
<!-- name: correlacao -->


<!-- ## ANÁLISE DE CORRELAÇÃO -->


<!-- --- -->

<!-- class: center, middle  -->


<!-- ```{r, echo = F, fig.align = 'center', fig.width = 7, fig.height = 4.3, dpi = 300} -->


<!-- correlacao <- respostas %>% -->

<!--   dplyr::mutate(genero = ifelse(genero == 'Masculino', 1, 0), -->

<!--                 origem_estudo = dplyr::case_when(origem_estudo == 'Apenas em escola pública' ~ 1, -->

<!--                                                  origem_estudo == 'Majoritariamente em escola pública' ~ 2, -->

<!--                                                  origem_estudo == 'Majoritariamente em escola privada' ~ 3, -->

<!--                                                  origem_estudo == 'Apenas em escola privada' ~ 4), -->

<!--                 religiosidade = ifelse(religiosidade == 'Sim', 1, 0), -->

<!--                 religiosidade_pai = ifelse(religiosidade_pai == 'Sim', 1, 0), -->

<!--                 religiosidade_mae = ifelse(religiosidade_mae == 'Sim', 1, 0), -->

<!--                 escolaridade_pai = dplyr::case_when(escolaridade_pai == 'Sem escolaridade' ~ 1, -->
<!--                                                     escolaridade_pai == 'Ensino básico (até 4º ano - primeiro grau)' ~ 2, -->
<!--                                                     escolaridade_pai == 'Ensino fundamental (até 9º ano - primeiro grau)' ~ 3, -->
<!--                                                     escolaridade_pai == 'Ensino Médio (até 3º ano - segundo grau)' ~ 4, -->
<!--                                                     escolaridade_pai == 'Graduação' ~ 5, -->
<!--                                                     escolaridade_pai == 'Mestrado' ~ 6, -->
<!--                                                     escolaridade_pai == 'Doutorado' ~ 7, -->
<!--                                                     escolaridade_pai == 'Pós-Doutorado' ~ 8), -->

<!--                 escolaridade_mae = dplyr::case_when(escolaridade_mae == 'Sem escolaridade' ~ 1, -->
<!--                                                     escolaridade_mae == 'Ensino básico (até 4º ano - primeiro grau)' ~ 2, -->
<!--                                                     escolaridade_mae == 'Ensino fundamental (até 9º ano - primeiro grau)' ~ 3, -->
<!--                                                     escolaridade_mae == 'Ensino Médio (até 3º ano - segundo grau)' ~ 4, -->
<!--                                                     escolaridade_mae == 'Graduação' ~ 5, -->
<!--                                                     escolaridade_mae == 'Mestrado' ~ 6, -->
<!--                                                     escolaridade_mae == 'Doutorado' ~ 7, -->
<!--                                                     escolaridade_mae == 'Pós-Doutorado' ~ 8)) %>% -->

<!--   dplyr::select(- carimbo, - participante, - naturalidade, - primeira_escolha, - segunda_escolha) -->


<!-- correlacao <- Hmisc::rcorr(as.matrix(correlacao)) -->


<!-- corrplot::corrplot(correlacao$r, p.mat = correlacao$P, sig.level = 0.005, type = 'lower') -->



<!-- ``` -->



